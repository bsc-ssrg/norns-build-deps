language: bash
services: docker

env:
  global:
    - ORGANIZATION=bscstorage
    - secure: X0cB8gsrUjR4VTzTUU8chCphohYtJ04YKb9Jb34Q0J+a07UTum2weafSVK+36xKDOVNxGUJJSf2Iv5DXxV0xe7DV907smX6nvdLRnCOVPoQKiXKUSa2VisDhq3urlZoYuS/pTcMy6YGpSj9KteQ7fgX6AXN2ziNkJX1ML4oSKPVDJX/xe8KwzDYSPYcIzm3TNjsxMiDVfrm6ykwDmZ696XhuUg/RaqYWtA/jWV/qEr2BYxsjiIrijzKZWiMCRU7xs2oGDxA7OtYCAbz4OcSpDSU8PFr0GwlBvJRl0Ya2G594NgZhD24JC2JhpliasZ7pqpYG+OfKRpfK/hj0rITyPT7xJ69sxeshS5w+eGl4+jrItyfO3F2U+XsYzJdZGyyxToa7lXv9Fe4c6f7BTtJxLLRUZmFh3rSEhdTmq3XPHMkcELy/FJNiBLyiJi18/P3Igyg9ota5kklDqnNm5JaVrRJXzB+cv1IkhwNfMJ50HK6ZNiR/nvU8n408YqCbPtnOyoA4XVttjomQOYQe+Mg+yS/il67qbQ/EjpbJcCDAlyMG8WlfmAjBhb0m7C+b4slT7ef4ty7kh0ghyDFfCFFDLR5ZDdh/Rm/6oe4KlASzU4KBAiT1LH7vdk97uImJd2Uxr9BDJLeCnn86l+1nuxKT0g00G+9LMOd+7/osag29NPM=
    - secure: hdY9MwGsAhh3pcfcW1GN8iCopTMHVjvKKzd5zLw4cI7VXUzHEOggXeqYXha20pTpIASY9Ka9in1Wn4TnkEcePuPeqSVt0r8fpXcqagVL2vUzDEiZvrZFwZp7ZPjEqAOFvz0z6AUooZ433lGq6z0sx8qUQIfvqG/dsS9KbgBTBxnNXf/GvGgP09omlmJbrq6VCz6DFR5lsKIjggSaGOdjqUuB0Nt3UsVdxBgw1wxDwXZXX83d3j5PT8wdpOOmimzDLGQIrbbVTxT/lEaKU2OF6P3hJjMzbr9wXHxI0EUvxk4aQLqhkHxkyU0n0bd+xu/btaFmPqUomcuxwZ1scJQDYPTnohmq2Ne2hmhP+DUWASJ616d/fTBieYpBgoP7yZQVoALndmqhKzBTfQsdag+Y+B9Q+bTgS4O127K8svDA1Gw51nPYT2CZCMHkeUorAIZSI5zH6ftErlAxCmNWga6sMKxkt+EvzHE8pwiDx/CiOpYn8NJoGqEeCmuuqS01YNH0Tk6m4E6Voupm2rMRXOU09I9b3gmkn5cRtdX2u67KSQKHSGLHapA+FS5CjZKUsCpGFbEkmfOnoV2t5dWQ8iUskYV2zBF8swNyr87F9PyOnfD+pNz+bsDYvCPX9hapkqsImOuRv+lzgp5a5HLVanLVy75AoD4S5GYZcncfBrzJMZA=
  matrix:
    - COMPILER=gcc    COMPILER_VERSION=4.8  LIBFABRIC_VERSION=1.7.1  MERCURY_VERSION=1.0.1
    - COMPILER=gcc    COMPILER_VERSION=4.9  LIBFABRIC_VERSION=1.7.1  MERCURY_VERSION=1.0.1
    - COMPILER=gcc    COMPILER_VERSION=5.4  LIBFABRIC_VERSION=1.7.1  MERCURY_VERSION=1.0.1
    - COMPILER=gcc    COMPILER_VERSION=6.5  LIBFABRIC_VERSION=1.7.1  MERCURY_VERSION=1.0.1
    - COMPILER=gcc    COMPILER_VERSION=7.4  LIBFABRIC_VERSION=1.7.1  MERCURY_VERSION=1.0.1
    - COMPILER=gcc    COMPILER_VERSION=8.1  LIBFABRIC_VERSION=1.7.1  MERCURY_VERSION=1.0.1
    - COMPILER=gcc    COMPILER_VERSION=9.1  LIBFABRIC_VERSION=1.7.1  MERCURY_VERSION=1.0.1
    - COMPILER=clang  COMPILER_VERSION=4.8  LIBFABRIC_VERSION=1.7.1  MERCURY_VERSION=1.0.1
    - COMPILER=clang  COMPILER_VERSION=4.9  LIBFABRIC_VERSION=1.7.1  MERCURY_VERSION=1.0.1
    - COMPILER=clang  COMPILER_VERSION=5.4  LIBFABRIC_VERSION=1.7.1  MERCURY_VERSION=1.0.1
    - COMPILER=clang  COMPILER_VERSION=6.5  LIBFABRIC_VERSION=1.7.1  MERCURY_VERSION=1.0.1
    - COMPILER=clang  COMPILER_VERSION=7.4  LIBFABRIC_VERSION=1.7.1  MERCURY_VERSION=1.0.1
    - COMPILER=clang  COMPILER_VERSION=8.1  LIBFABRIC_VERSION=1.7.1  MERCURY_VERSION=1.0.1
    - COMPILER=clang  COMPILER_VERSION=9.1  LIBFABRIC_VERSION=1.7.1  MERCURY_VERSION=1.0.1

before_script:
  - env | sort
  - cd "${COMPILER}/${COMPILER_VERSION}"
  - IMAGE="norns-build-deps:${COMPILER}${COMPILER_VERSION}-${LIBFABRIC_VERSION}-${MERCURY_VERSION}"

script:
  - |
    (
      set -Eeuo pipefail
      set -x
      #docker build -t "$IMAGE" .
      echo "${ORGANIZATION}/${IMAGE}"
    )

after_script:
  - docker images
